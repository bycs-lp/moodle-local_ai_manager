define("local_ai_manager/userquota",["exports","core/ajax","core/str","core/templates"],(function(_exports,_ajax,_str,_templates){var obj;
/**
   * Module handling the form submission of the statistics tables of local_ai_manager.
   *
   * @module     local_ai_manager/userquota
   * @copyright  2024 ISB Bayern
   * @author     Philipp Memmel
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.renderUserQuota=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};const constants_MAXUSAGE_UNLIMITED=999999,queryCountStrings={chat:"chat requests",feedback:"feedback requests",imggen:"image generation generation requests",singleprompt:"text requests",translate:"translation requests",tts:"audio requests"};_exports.renderUserQuota=async(selector,purposes)=>{await localizeQueryCountTexts();const targetElement=document.querySelector(selector),userquotaData=await(0,_ajax.call)([{methodname:"local_ai_manager_get_user_quota",args:{}}])[0],purposeInfo=[];console.log(userquotaData),purposes.forEach((purpose=>{purposeInfo.push({purpose:purpose,currentusage:userquotaData.usage[purpose].currentusage,maxusage:userquotaData.usage[purpose].maxusage,querycounttext:queryCountStrings[purpose],showmaxusage:userquotaData.usage[purpose].maxusage!==constants_MAXUSAGE_UNLIMITED,islastelement:!1})})),purposeInfo[purposeInfo.length-1].islastelement=!0,console.log(purposeInfo);const userquotaContentTemplateContext={purposes:purposeInfo,period:userquotaData.period},{html:html,js:js}=await _templates.default.renderForPromise("local_ai_manager/userquota",userquotaContentTemplateContext);_templates.default.appendNodeContents(targetElement,html,js)};const localizeQueryCountTexts=async()=>{const stringsToFetch=[];Object.keys(queryCountStrings).forEach((key=>{stringsToFetch.push({key:"requestcount",component:"aipurpose_"+key})}));const strings=await(0,_str.getStrings)(stringsToFetch);let i=0;for(const key in queryCountStrings)queryCountStrings[key]=strings[i],i++}}));

//# sourceMappingURL=userquota.min.js.map